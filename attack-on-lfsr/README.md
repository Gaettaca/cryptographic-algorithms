#### Дешифровка файлов, зашифрованных с помощью регистра сдвига с линейной обратной связью (LFSR).

В компанию,чьими зашифрованными документами мы интересуемся, внедрился наш агент. Ему удалось узнать, что документы представляют из себя файлы формата fb2 (что выдает внутреннюю структуру документов), зашифрованы с помощью [linear-feedback shift register (LFSR)](https://en.wikipedia.org/wiki/Linear-feedback_shift_register), а также то, что LFSR использует [примитивный многочлен](https://en.wikipedia.org/wiki/Primitive_polynomial_(field_theory)) степени 16, а именно, $f(x) = x^{16} + x^{15} + x^{12} + x^{10} + 1$. На самом деле, даже, если агент и не узнал бы точную формулу примитивного многочлена, нам бы хватило и того, что мы знаем его степень. В таком случае, мы бы просто перебрали все примитивные многочлены 16-ой степени (их всего 2048). LFSR генератор с примитивным многочленом степени 16, даёт $2^{16} - 1 = 65535$ последовательностей, с которых могло быть начато шифрование файла (т.е. для каждой из 65535 последовательностей нам придется расшифровывать текст и проверять - является он осмысленным или нет, если да, то мы высоко вероятно нашли ключ к расшифровке всего файла).
 
 Реализация LFSR-генератора находится в [./LFSR.h](https://github.com/Gaettaca/cryptographic-algorithms/blob/main/attack-on-lfsr/LFSR.h), а реализации других видов генератов, а также исследование их свойств в [./generators.ipynb](https://github.com/Gaettaca/cryptographic-algorithms/blob/main/attack-on-lfsr/generators.ipynb).
 
 С помощью кода ниже, мы будем искать какая из 65535 последовательностей является ключом. Для этого будем расшифровывать первые 100 байт шифр-текста.
 
 <img src="https://user-images.githubusercontent.com/74289495/226992329-0a9b42ef-9b96-4c1c-88f3-1420466344d5.png" width=50% height=50%>

 Шифр-текст выглядит следующим образом:
 
 <img src="https://user-images.githubusercontent.com/74289495/226993642-5f2fdff8-0e48-477f-91a4-0adc5ba8d328.png" width=70% height=70%>
 
 Как среди 65535 расшифрованных последовательностей найти подходящую нам? Для этого нам пригодилась информация, о том, что документы имеют формат fb2. У fb2 есть чёткая внтуренняя структура. Поэтому среди 65535 последовательностей будем искать, кусочки текста, с которых обычно начинается fb2 документ (например, тег <FictionBook>):

 <img src="https://user-images.githubusercontent.com/74289495/226995913-c6d67725-66e6-40b6-9119-61f4f54469c6.png" width=70% height=70%>
  
  Наша искомая последовательность нашлась под номером 34903, она расшифровала 100 байт в осмысленный текст:

 <img src="https://user-images.githubusercontent.com/74289495/226996438-d972c598-1918-4413-a545-7d60e35dda2f.png" width=70% height=70%>

  Осталось создать генератор, начинающийся с 34903 последовательности, и расшифровать документ:
  
 <img src="https://user-images.githubusercontent.com/74289495/226999212-77cad937-b473-4b61-ba87-d00ac5a6599d.png" width=50% height=50%>
  
  Зашифрованным документом оказалась книга "Гроздья гнева, Стейнбека":
 <img src="https://user-images.githubusercontent.com/74289495/227003783-30e3b1e2-dcff-4db5-a64d-d65910102a06.png" width=70% height=70%>
